<html>
<body>

<% @accep_user = AcceptableUser.new %>

<% if @user.profilepicture_file_name.blank?%>
	<h1 class = "text-center"><img alt="Dude" src="/assets/icons/dude.svg"></h1>
<% else %>
	<h1 class = "text-center"><img alt="Dude" class = "clip-circle" src= <%=@user.profilepicture.url%>></h1>
<%end%>
<section class = "white-background">

	<h1 class = "text-center"><%=@user.first_name%> <%=@user.last_name%></h1>
	<p class = "text-center"><%=@user.email%></p>

	<% if @user.linkedin_url.blank?%>
	<%else%>
		<div class = "text-center"><a class="fui-linkedin" href = <%=@user.linkedin_url%> target="_blank"></a>
	<%end%>

	<%if @user.github_username.blank?%>
	<%else%>
		<a class="fui-github" href = <%=@user.github_username%> target="_blank"></a>
		</div>  
	<%end%>

	<div class="text-center">
		<button type="button" class="btn btn-info" data-toggle="modal" data-target="#resume_modal">
		Resume
		</button>
	</div>

</section>



<section class= "dark-blue" id = "about">
	<p class = "text-center"><%=@user.about_me%></p>
</section>

<div id="resume_modal" class="modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div style= "height: 1200px; width: 1000px" class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="myModalLabel">Resume</h4>
      </div>
      <div class="modal-body">
      	<object src=<%=@user.resume.url%>><embed style= "height: 1000px; width: 900px" src=<%=@user.resume.url%>></embed></ob
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- If current user is an admin, show admin settings options. -->
<% if current_user.user_type_id == 2 && @user.id == current_user.id %>
	<div class = "student-ids">
		<%= form_for @accep_user, to: "acceptable_users#create" do |f| %>
		
			<div class = "form-group">
				<%= f.text_field :user_id %>
			</div>
			<div class = "form-group">
				<%= f.hidden_field :added_by, :value => current_user.id %>
			</div>
			<div class="form-group" >
		    	<%= button_tag(class: "btn btn-lg btn-primary") do%>
		    		<%=content_tag(:strong, 'Add ID') %>
		    	<% end %>
		    </div>
		<% end %>
	</div>
	<!-- Free Users -->
	<div class="users-list">
		<div class = "users-list-team">
			<h4> Available Users </h4>
			<% free_users = User.where(team_id: nil) %>
			<% free_users.each do |freeUser| %>
				<div id="single-user">
					<% imageLoc = freeUser.profilepicture_file_name %>
					<% if !imageLoc.blank?%>
						<%= link_to image_tag(imageLoc, alt: "Image Error", class: "img-circle", float: 'left'), controller: "users", action: "show", id: freeUser.id %>
					<% else %>
						<%= link_to image_tag("icons/dude.svg", alt: "Image Error", class: "img-circle", float: 'left'), controller: "users", action: "show", id: freeUser.id %> 
					<% end %>
					<!-- Drop Down under user picture -->
					<div class="btn-group">
					  <button class="btn btn-inverse btn-xs dropdown-toggle" type="button" data-toggle="dropdown">
					    <%= freeUser.first_name %> <span class="caret"></span>
					  </button>
					  <ul class="dropdown-menu dropdown-menu-inverse" role="menu">
					    <li><%= link_to "Profile", {:controller => "users", :action => "show", :id => freeUser.id} %>
					    </li>
				    	<li><%= link_to "Delete User", {:controller => "users", :action => "destroy", :id => freeUser.id, :adminid => current_user.id}, :method => "delete", data: { confirm: "Are you sure you want to delete #{freeUser.first_name} #{freeUser.last_name}?"} %>
				    	</li>
					  </ul>
					</div>
				</div>
			<% end %>
		</div>
	</div>
	<!-- Teams with users -->
	<div class="users-list">
		<% allTeams = Team.all %>
		<% allTeams.each do |team| %>
			<% usersInTeam = User.where(team_id: team.id) %>
			<% if !usersInTeam.blank? %>
				<h4 margin: '30'><%=link_to team.name, controller: "teams", action: "show", id: team.id %></h4>
				<div class="btn-group">
					<%= link_to "Disban Team", {:controller => "teams", :action => "destroy", :id => team.id}, :method => "delete", class: "btn btn-default btn-xs", data: { confirm: "Are you sure you want to disban #{team.name}?"} %>
				</div>
				<div class="users-list-team">
					<% usersInTeam.each do |userInTeam| %>
						<div id="single-user">
							<% imageLoc = userInTeam.profilepicture_file_name %>
							<% if !imageLoc.blank?%>
								<%= link_to image_tag(imageLoc, alt: "Image Error", class: "img-circle", float: 'left'), controller: "users", action: "show", id: userInTeam.id %>
							<% else %>
								<%= link_to image_tag("icons/dude.svg", alt: "Image Error", class: "img-circle", float: 'left'), controller: "users", action: "show", id: userInTeam.id %> 
							<% end %>
							<div class="btn-group">
							  <button class="btn btn-inverse btn-xs dropdown-toggle" type="button" data-toggle="dropdown">
							    <%= userInTeam.first_name %> <span class="caret"></span>
							  </button>
							  <ul class="dropdown-menu dropdown-menu-inverse" role="menu">
							    <li><%= link_to "Profile", {:controller => "users", :action => "show", :id => userInTeam.id} %>
							    </li>
							    <li><%= link_to "Remove from Team", {:controller => "users", :action => "change_team", :id => userInTeam.id, :team_id => nil}, :method => "put", data: { confirm: "Are you sure you want to remove #{userInTeam.first_name} #{userInTeam.last_name} from #{team.name}?"} %>
						    	</li>
						    	<li><%= link_to "Delete User", {:controller => "users", :action => "destroy", :id => userInTeam.id, :adminid => current_user.id}, :method => "delete", data: { confirm: "Are you sure you want to delete #{userInTeam.first_name} #{userInTeam.last_name}?"} %>
						    	</li>
							  </ul>
							</div>
						</div>
					<% end %>
				</div>
			<% end %>
		<% end %>
	</div>
<% end %>
</body>
</html>